关于pocketbase版本
```
pocketbase版本分别配置在：
project-tools-node\project-config.js
pocketbase\CHANGELOG.md
dockerfile

如果要更改pocketbase版本，就需要更改以上这些地方
pocketbase\CHANGELOG.md 为从 pocketbase 复制的
```

pocket-chat 项目目录结构
- `pocketbase/` 为 PocketBase 所在的文件夹
- `vue3/` 为 Vue3 前端文件夹
- `project-tools-node/` 为项目打包工具脚本文件夹
- `resources/` 为项目中所用到的一些图片资源
- `note/` 为项目开发过程中的一些笔记（在本项目中很少，更多的在 [PocketTogether](#关于-pockettogether) 中）
- `assets/` README.md 中使用的一些图片

主开发分支为 develop

### pocketbase 后端

建议用 vscode 打开 `pocketbase/` 目录进行开发（而不是打开 本项目根目录），比如修改 `pocketbase/pb_hooks/` 目录中的 js 文件时，要借助 `pocketbase/jsconfig.json` 使其更类型严格，`pocketbase/pb_hooks/` 目录中的 js 代码应使用 jsDoc 来设置类型。

为了不增加项目git体积，为 `pocketbase.exe` 配置了忽略，即本项目仓库中并不包含 `pocketbase.exe` ，在进行开发前需要手动下载 `pocketbase.exe` ，在 https://github.com/pocketbase/pocketbase/releases 下载压缩包，解压后将 `pocketbase.exe` 复制到本项目 `pocketbase/` 目录中。

关于本项目所使用的 `pocketbase.exe` 具体版本可以查看 `pocketbase/CHANGELOG.md` ，以其中最新（最靠上）的版本为准。

双击 `pocketbase/start.sh` 即可启动本项目的 PocketBase

如果在本项目的 PocketBase 的 Web UI 中修改了数据库架构，请在 `http://127.0.0.1:58090/_/#/settings/export-collections` 将其内容复制到 `pocketbase/pb_schema.json` ，并在前端重新 [生成后端数据库的 TS 类型](#生成后端数据库的-ts-类型)。

关于 `pocketbase/pb_schema.json` ，pocketbase 的运行并不依赖于这个文件，其目的主要是为了借助git更清晰地观察数据库架构变化。此外它的另一个重要用处是帮助前端 [生成后端数据库的 TS 类型](#生成后端数据库的-ts-类型)

### vue3 前端
建议用 vscode 打开 `vue3/` 目录进行开发（而不是打开 本项目根目录）
```sh
# Project Setup
pnpm install

# Compile and Hot-Reload for Development
pnpm dev

# Type-Check, Compile and Minify for Production
pnpm build

# Lint with ESLint
pnpm lint
```

#### 生成后端数据库的 TS 类型
本项目使用 [pocketbase-typegen](https://www.npmjs.com/package/pocketbase-typegen) 来在前端生成 pocketbase 后端的数据类型：
```sh
pnpm pb-typegen-json

# "pb-typegen-json": "pocketbase-typegen --json ../pocketbase/pb_schema.json --out ./src/lib/pocketbase/pocketbase-types.ts"
```

## 发布
```
更新/检查 README.md 

更新 CHANGELOG.md
可到GitHub的Release草稿页获取pr信息

本地打包测试，前端构建、项目打包（可选）
---
cd vue3
pnpm build
---
cd project-tools-node
node project-package.js 0.1.1

github release published 触发 github actions Release
```

## 已部署项目的更新
```
先停止
systemctl stop pocketchat

将全部内容打包zip以备份（可选）

删除除 pb_data 外的所有文件及文件夹

从 github release 下载新版的 pocketchat，并解压

注意
- 如果改过端口，需要在start.sh中再次修改
- 如果改过pb_public/index.html，需要再次修改
- 需确认 pocketbase 可执行文件是否由执行权限

再启动
systemctl start pocketchat

查看状态
systemctl status pocketchat

没问题，完成更新
```